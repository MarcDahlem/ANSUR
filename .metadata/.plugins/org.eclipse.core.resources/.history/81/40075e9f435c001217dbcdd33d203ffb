package com.example.streamwithvlc;

import java.util.ArrayList;
import java.util.List;

import classes.Camera;
import classes.MyCustomAdapter.ViewHolder;

import android.R;
import android.app.Activity;
import android.content.Context;
import android.os.Bundle;
import android.util.Log;
import android.view.LayoutInflater;
import android.view.Menu;
import android.view.View;
import android.view.ViewGroup;
import android.widget.AdapterView;
import android.widget.AdapterView.OnItemClickListener;
import android.widget.ArrayAdapter;
import android.widget.CheckBox;
import android.widget.ListView;
import android.widget.TextView;
import android.widget.Toast;

public class ListCamerasActivity extends Activity {

	ArrayList<String> camerasList = new ArrayList<String>();
	ArrayAdapter<String> aa;
	ListView camerasListView;
	List<Camera> subscribedCameras = new ArrayList<Camera>();

	@Override
	protected void onCreate(Bundle savedInstanceState) {
		super.onCreate(savedInstanceState);
		setContentView(R.layout.activity_list_cameras);

		// Gets the listview
		camerasListView = (ListView) findViewById(R.id.camerasListView);
		// set resID to be a specefic layout
		int resID = android.R.layout.simple_list_item_multiple_choice;
		camerasList.add((new Camera("Cam1", "Kitchen", 1000, false)).toString());
		camerasList.add((new Camera("Cam2", "Bedroom", 2000, false)).toString());
		// Combine the list to the layout
		aa = new ArrayAdapter<String>(this.getApplicationContext(), resID,camerasList);

		// Sets the adapter into the view
		camerasListView.setAdapter(aa);

		
		aa.notifyDataSetChanged();
		camerasListView.setTextFilterEnabled(true);

		camerasListView.setOnItemClickListener(new OnItemClickListener() {
			public void onItemClick(AdapterView<?> parent, View view,
					int position, long id) {

				// When clicked, show a toast with the TextView text
				String text = ((TextView) view).getText().toString();
				Toast toast = Toast.makeText(getApplicationContext(),
						"Clicked on: \n" + text, Toast.LENGTH_SHORT);
				toast.show();
			}
		});
	}

	@Override
	public boolean onCreateOptionsMenu(Menu menu) {
		// Inflate the menu; this adds items to the action bar if it is present.
		getMenuInflater().inflate(R.menu.activity_list_cameras, menu);
		return true;
	}

	public void onClick(View view) {

    	Toast toast;
    	switch(view.getId()) {
    	case R.id.subscribe_button:
    		toast = Toast.makeText(getApplicationContext(),"Subscribing to: ", Toast.LENGTH_SHORT);
			toast.show();
			break;
			
    	case R.id.refresh_button:
    		toast = Toast.makeText(getApplicationContext(),"Refreshing list", Toast.LENGTH_SHORT);
			toast.show();
    		break;
    		
    	case R.id.cameras_back_button:
    		finish();
    		break;
    	}
	}
	
	private class MyCustomAdapter extends ArrayAdapter<Camera> {
		private ArrayList<Camera> countryList;
		 
		  public MyCustomAdapter(Context context, int textViewResourceId, 
		    ArrayList<Camera> countryList) {
		   super(context, textViewResourceId, countryList);
		   this.countryList = new ArrayList<Camera>();
		   this.countryList.addAll(countryList);
		  }
		 
		  private class ViewHolder {
		   TextView code;
		   CheckBox name;
		  }
		 
		  @Override
		  public View getView(int position, View convertView, ViewGroup parent) {
		 
		   ViewHolder holder = null;
		   Log.v("ConvertView", String.valueOf(position));
		 
		   if (convertView == null) {
		   LayoutInflater vi = (LayoutInflater)getSystemService(
		     Context.LAYOUT_INFLATER_SERVICE);
		   convertView = vi.inflate(R.layout., null);
		 
		   holder = new ViewHolder();
		   holder.code = (TextView) convertView.findViewById(R.id.code);
		   holder.name = (CheckBox) convertView.findViewById(R.id.checkBox1);
		   convertView.setTag(holder);
		 
		    holder.name.setOnClickListener( new View.OnClickListener() {  
		     public void onClick(View v) {  
		      CheckBox cb = (CheckBox) v ;  
		      Camera country = (Camera) cb.getTag();  
		      Toast.makeText(getApplicationContext(),
		       "Clicked on Checkbox: " + cb.getText() +
		       " is " + cb.isChecked(), 
		       Toast.LENGTH_LONG).show();
		      country.setSelected(cb.isChecked());
		     }  
		    });  
		   } 
		   else {
		    holder = (ViewHolder) convertView.getTag();
		   }
		 
		   Camera country = countryList.get(position);
		   holder.code.setText(" (" +  country.getCode() + ")");
		   holder.name.setText(country.getName());
		   holder.name.setChecked(country.isSelected());
		   holder.name.setTag(country);
		 
		   return convertView;
		 
		  }
		 
		 }
	
}
